<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Catalogue</title>
<script>
  // Helper functions for cookies
  function setCookie(name, value, days) {
    const d = new Date();
    d.setTime(d.getTime() + (days*24*60*60*1000));
    document.cookie = name + "=" + value + ";expires=" + d.toUTCString() + ";path=/";
  }

  function getCookie(name) {
    const cookies = document.cookie.split(';');
    for (let c of cookies) {
      let [key, value] = c.trim().split('=');
      if (key === name) return value;
    }
    return null;
  }

  // Load the correct CSS
  function loadStyle() {
    const styleChoice = getCookie('theme') || 'new'; // default 'new'
    const link = document.createElement('link');
    link.rel = 'stylesheet';
    link.href = styleChoice === 'old' ? 'styles-old.css' : 'styles.css';
    document.head.appendChild(link);
  }

  loadStyle();

  // Function to toggle style
  function toggleStyle() {
    const currentTheme = getCookie('theme') || 'new';
    const newTheme = currentTheme === 'old' ? 'new' : 'old';
    setCookie('theme', newTheme, 30); // persist for 30 days
    location.reload(); // reload page to apply new CSS
  }
</script>
</head>

<body>
  <header class="navbar">
    <div class="logo">
      <a href="index.html"><img src="../images/logo-wide-1.png" alt="Logo" style="height: 40px;"></a>
    </div>
    <nav>
      <a href="index.html">Home</a>
      <a href="catalogue.html">Catalogue</a>
      <a href="about.html">About</a>
    </nav>
  </header>

  <main>
    <button onclick="toggleStyle()" 
        style="
          position: fixed;
          bottom: 20px;
          right: 20px;
          padding: 8px 12px;
          font-size: 12px;
          border-radius: 8px;
          border: none;
          background-color: #882b00;
          color: #ffffff;
          cursor: pointer;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
          z-index: 1000;
        ">
      ‚ó™
    </button>

    <h1>RailZone Catalogue</h1>
    <p>Below are the articles about Sri Lanka Railways. All photos are copyright material of ChipFlare Studios.</p>

    <section class="category-list" id="catalogue">
      </section>
  </main>

  <script>
    const navbar = document.querySelector('.navbar');
    window.addEventListener('scroll', () => {
      navbar.classList.toggle('scrolled', window.scrollY > 10);
    });

    fetch('catalogue.json')
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById('catalogue');

        for (const category in data) {
          const section = document.createElement('div');
          section.className = 'category';

          const heading = document.createElement('h2');
          heading.textContent = category;
          section.appendChild(heading);

          const ul = document.createElement('ul');

          data[category].forEach(item => {
            const li = document.createElement('li');
            const wrapper = document.createElement('div');
            wrapper.className = 'item';

            // üõ†Ô∏è Use item.url directly for the link
            const imgLink = document.createElement('a');
            imgLink.href = item.url; // Use 'item.url' from the new JSON structure

            const img = document.createElement('img');
            img.src = item.image;
            img.alt = item.name;

            imgLink.appendChild(img);

            const textWrapper = document.createElement('div');
            textWrapper.className = 'item-text';

            const link = document.createElement('a');
            link.href = item.url; // Use 'item.url' from the new JSON structure
            link.textContent = item.name;

            const desc = document.createElement('div');
            desc.className = 'desc';
            desc.textContent = item.description;

            textWrapper.appendChild(link);
            textWrapper.appendChild(desc);

            wrapper.appendChild(imgLink);
            wrapper.appendChild(textWrapper);

            li.appendChild(wrapper);
            ul.appendChild(li);
          });

          section.appendChild(ul);
          container.appendChild(section);
        }
      });
    
    const imageCount = 4;
    let currentImage = 1;
    const bodyElement = document.body;
    
    // Preload images
    for (let i = 1; i <= imageCount; i++) {
        new Image().src = `images/banners/${i}.jpg`;
    }

    function changeBackground() {
        bodyElement.style.backgroundImage = `url('images/banners/${currentImage}.jpg')`;
        currentImage = currentImage % imageCount + 1;
    }

    changeBackground(); 
    setInterval(changeBackground, 5000); 
  </script>
</body>
</html>