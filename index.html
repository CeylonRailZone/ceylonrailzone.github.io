<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="google-site-verification" content="QRBMYjU0v6J_gGg8ythm3KAWXIhDhIdYtu1myKZDDH0" />
  <title>Ceylon RailZone</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    body {
      background-image: none !important;
      position: relative;
    }

  </style>
</head>
<body>

  <div id="background-blur-layer"></div>

  <header class="navbar">
    <div class="logo">
      <a href="index.html"><img src="../images/logo-wide-1.png" alt="Logo" style="height: 40px;"></a>
    </div>
    <nav>
      <!-- ðŸ” Search added here -->
      <input type="search" id="search" placeholder="Search...">
      <a href="data.html?id=about" >?</a>
    </nav>
  </header>

  <main class="content">
    <div id="intro">
      <h1>Ceylon RailZone</h1>
      <p style="padding:15px;">This website is under construction! 
        <a href="data.html?id=about" style="color:#ffd700;">Learn more.</a>
      </p>
    </div>

    <section class="category-list" id="catalogue"></section>
  </main>

  <script>
    const navbar = document.querySelector('.navbar');
    window.addEventListener('scroll', () => {
      navbar.classList.toggle('scrolled', window.scrollY > 10);
    });

    document.addEventListener('click', e => {
      const target = e.target;
      if (target.tagName === 'IMG' && 
          (target.classList.contains('project-image') || target.classList.contains('description-image'))) {
        window.open(target.src, '_blank');
      }
    });

    // --- Background Fading Script ---
    const imageCount = 9;
    let currentImage = Math.floor(Math.random() * imageCount) + 1;
    const backgroundLayer = document.getElementById('background-blur-layer');

    for (let i = 1; i <= imageCount; i++) {
      new Image().src = `images/banners/${i}.jpg`;
    }

    function changeBackground() {
      const newBackground = `url('images/banners/${currentImage}.jpg')`;
      backgroundLayer.style.backgroundImage = newBackground;
      currentImage = currentImage % imageCount + 1;
    }

    changeBackground();
    setInterval(changeBackground, 10000);

    // --- Catalogue Loading + Search ---
    let allItems = [];

    fetch('catalogue.json')
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById('catalogue');
        let globalIndex = 0;

        for (const category in data) {
          const section = document.createElement('div');
          section.className = 'category';

          const heading = document.createElement('h2');
          heading.textContent = category;
          section.appendChild(heading);

          const ul = document.createElement('ul');

          data[category].forEach(item => {
            const li = document.createElement('li');
            const wrapper = document.createElement('div');
            wrapper.className = 'item';
            wrapper.style.opacity = '0';
            wrapper.style.transform = 'translateY(20px)';
            wrapper.style.animation = `fadeInUp 0.6s forwards`;
            wrapper.style.animationDelay = `${globalIndex * 0.02}s`;
            globalIndex++;

            const imgLink = document.createElement('a');
            imgLink.href = item.url;

            const img = document.createElement('img');
            img.src = item.image;
            img.alt = item.name;
            img.loading = "lazy";

            imgLink.appendChild(img);

            const textWrapper = document.createElement('div');
            textWrapper.className = 'item-text';

            const link = document.createElement('a');
            link.href = item.url;
            link.textContent = item.name;

            const desc = document.createElement('div');
            desc.className = 'desc';
            desc.textContent = item.description;

            textWrapper.appendChild(link);
            textWrapper.appendChild(desc);
            wrapper.appendChild(imgLink);
            wrapper.appendChild(textWrapper);
            li.appendChild(wrapper);
            ul.appendChild(li);

            allItems.push(li); // collect for search
          });

          section.appendChild(ul);
          container.appendChild(section);
        }

        // --- ðŸ” Search Filter Function ---
        const searchInput = document.getElementById('search');
        searchInput.addEventListener('input', () => {
          const query = searchInput.value.toLowerCase();
          allItems.forEach(li => {
            const name = li.querySelector('.item-text a').textContent.toLowerCase();
            const desc = li.querySelector('.desc').textContent.toLowerCase();
            li.style.display = (name.includes(query) || desc.includes(query)) ? '' : 'none';
          });
        });
      searchInput.addEventListener('keydown', (e) => {
  if (e.key === 'Enter') {
    const query = searchInput.value.toLowerCase();
    const firstMatch = allItems.find(li => {
      const title = li.querySelector('.item-text a').textContent.toLowerCase();
      return title.includes(query);
    });
    if (firstMatch) {
      const link = firstMatch.querySelector('.item-text a');
      if (link) window.location.href = link.href; // or use window.open(link.href, '_blank') for new tab
    }
  }
});
      });


    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeInUp {
        to { opacity: 1; transform: translateY(0); }
      }
    `;
    document.head.appendChild(style);
  </script>

</body>
</html>
